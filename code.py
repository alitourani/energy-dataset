# -*- coding: utf-8 -*-
"""EnergyDataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1t9gb4mlUTHooFKvDbPNZif8d1mpzZp5C

**Pre-requistics: Mount Google Drive**
"""

from google.colab import drive
drive.mount('/content/drive/')

"""**Step 1 - Import CSV Dataset**"""

# Get access to the existing dataset file
datasetPath = '/content/drive/Somewhere/Input.csv'

# Load .csv dataset
import csv

currentData = []      # Holds current data of dataset

with open(datasetPath) as csv_file:
    csv_reader = csv.reader(csv_file, delimiter=',')
    lineCount = 0
    for row in csv_reader:
        #print(f'Day #{row[0]} at {row[1]} - Temp: {row[2]},  Humidity: {row[3]},  Wind speed: {row[4]}.')
        currentData.append(row)
        lineCount += 1   
    print(f'Number of data instances: {lineCount}')

# Generate data
import numpy as np
import pandas as pd
import random

latestDataInstance = currentData[lineCount-1]   # Holds the latest existing data
print(f'Latest real instance in the dataset: #{latestDataInstance}')

extendedData = currentData    # Holds the extended dataset (real values + generated values)
numberOfExistingDays = 2      # Days existed in the dataset
numberOfGeneratedDays = 6     # Days to be generated
hoursArray = ['0:00','0:15', '0:30', '0:45', '1:00', '1:15', '1:30', '1:45', '2:00', '2:15', '2:30', '2:45', '3:00', 
              '3:15', '3:30', '3:45', '4:00', '4:15', '4:30', '4:45', '5:00', '5:15', '5:30', '5:45', '6:00', '6:15',
              '6:30', '6:45', '7:00', '7:15', '7:30', '7:45', '8:00', '8:15', '8:30', '8:45', '9:00', '9:15', '9:30',
              '9:45', '10:00', '10:15', '10:30', '10:45', '11:00', '11:15', '11:30', '11:45', '12:00', '12:15', '12:30',
              '12:45', '13:00', '13:15', '13:30', '13:45', '14:00', '14:15', '14:30', '14:45', '15:00', '15:15', '15:30',
              '15:45', '16:00', '16:15', '16:30', '16:45', '17:00', '17:15', '17:30', '17:45', '18:00', '18:15', '18:30',
              '18:45', '19:00', '19:15', '19:30', '19:45', '20:00', '20:15', '20:30', '20:45', '21:00', '21:15', '21:30',
              '21:45', '22:00', '22:15', '22:30', '22:45', '23:00', '23:15', '23:30', '23:45']

latestTemperature = float(latestDataInstance[2])
latestHumidity = float(latestDataInstance[3])

for counter in range(numberOfExistingDays+1, numberOfExistingDays+numberOfGeneratedDays+1):
  currentDay = counter
  hourIndex = 0   # Shows which portion of the day we are in (0-95 for 0:00 to 23:45)
  for hour in hoursArray:
    # Temperature prediction
    # If time is less than 16:15, coefficient is positive, makes the temperature warmer (else, colder)
    timeBasedCoefficient = 1.9 if (hourIndex < 57) else -2.8
    generatedTemperature = latestTemperature + (timeBasedCoefficient * random.uniform(0.05, 0.1))
    # Humidity
    generatedHumidity = latestHumidity + (random.uniform(1, 3.5) * random.choice([-1,1]))
    if (generatedHumidity > 92):
      generatedHumidity = 92 - (generatedHumidity - 92.0)
    if (generatedHumidity < 62):
      generatedHumidity = 62 + (62.0 - generatedHumidity)
    # Wind speed prediction
    generatedWindspeed = random.uniform(1.25, 1.76)
    # print(f'Day #{currentDay} at {hour} - Temp: {generatedTemperature},  Humidity: {generatedHumidity},  Wind speed: {generatedWindspeed}.')
    latestRecord = [str(currentDay), hour, generatedTemperature, generatedHumidity, generatedWindspeed]
    # Update latest records
    latestTemperature = generatedTemperature
    latestHumidity = generatedHumidity
    hourIndex += 1
    # Add to the dataset
    extendedData.append(latestRecord)

# Export data to a .csv file
# print(f'Latest Data: {extendedData}.')
pd.DataFrame(extendedData).to_csv("/content/drive/MyDrive/Somewhere/NewDataset.csv")
# np.savetxt("Dataset.csv", extendedData, delimiter=",")